<ol class="items-list effects-list">
  {{#each effects as |section sid|}}
    <li class="items-header flexrow" data-effect-type="{{section.type}}" data-parent-id="{{@root.actor.id}}" >
      <h3 class="item-name effect-name flexrow">{{localize section.label}}</h3>
      <div class="effect-source">{{localize "ASPECTSOFPOWER.Effect.Source"}}</div>
      <div class="effect-source">{{localize "EFFECT.TabDuration"}}</div>
      <div class="item-controls effect-controls flexrow">
        <a class="effect-control" data-action="create" title="{{localize 'DOCUMENT.Create' type="Effect"}}">
          <i class="fas fa-plus"></i> {{localize "DOCUMENT.New" type="Effect"}}
        </a>
      </div>
    </li>

    <ol class="item-list">
    {{#each section.effects as |effect|}}
      <li class="item effect flexrow" data-effect-id="{{effect.id}}" data-parent-id="{{effect.parent.id}}">
        <div class="item-name effect-name flexrow">
          <img class="item-image" src="{{effect.img}}"/>
          <h4>{{effect.name}}</h4>
        </div>
        <div class="effect-source">{{effect.sourceName}}</div>
        <div class="effect-duration">{{effect.duration.label}}</div>
        <div class="item-controls effect-controls flexrow">
          <a class="effect-control" data-action="toggle" title="{{localize 'ASPECTSOFPOWER.Effect.Toggle'}}">
            <i class="fas {{#if effect.disabled}}fa-check{{else}}fa-times{{/if}}"></i>
          </a>
          <a class="effect-control" data-action="edit" title="{{localize 'DOCUMENT.Update' type="Effect"}}">
            <i class="fas fa-edit"></i>
          </a>
          <a class="effect-control" data-action="delete" title="{{localize 'DOCUMENT.Delete' type="Effect"}}">
            <i class="fas fa-trash"></i>
          </a>
        </div>
      </li>

      {{!-- Inline stat change rows for blessings and titles --}}
      {{#if effect.changeRows}}
        <li class="effect-changes-section" data-effect-id="{{effect.id}}">
          <div class="effect-changes-wrapper">
            <div class="effect-changes-header flexrow">
              <span class="effect-changes-label">{{localize "ASPECTSOFPOWER.Effect.StatChanges"}}</span>
              <a class="effect-change-add" data-effect-id="{{effect.id}}" title="{{localize 'ASPECTSOFPOWER.Effect.AddChange'}}">
                <i class="fas fa-plus"></i>
              </a>
            </div>
            <div class="effect-changes-list">
              {{#each effect.changeRows as |row|}}
                <div class="effect-change-row flexrow" data-index="{{row.index}}" data-effect-id="{{@../effect.id}}">
                  <select class="effect-change-attribute" data-index="{{row.index}}">
                    {{#each @root.config.buffableAttributes as |label attrKey|}}
                      <option value="{{attrKey}}" {{#if (eq attrKey row.attribute)}}selected{{/if}}>
                        {{localize label}}
                      </option>
                    {{/each}}
                  </select>
                  <select class="effect-change-operation" data-index="{{row.index}}">
                    {{#each @root.config.effectOperations as |label opKey|}}
                      <option value="{{opKey}}" {{#if (eq opKey row.operation)}}selected{{/if}}>
                        {{localize label}}
                      </option>
                    {{/each}}
                  </select>
                  <input type="number" class="effect-change-value" data-index="{{row.index}}"
                         value="{{row.displayValue}}" step="any" />
                  <a class="effect-change-delete" data-index="{{row.index}}" data-effect-id="{{@../effect.id}}" title="Remove">
                    <i class="fas fa-trash"></i>
                  </a>
                </div>
              {{/each}}
            </div>
          </div>
        </li>
      {{/if}}

    {{/each}}
    </ol>
  {{/each}}
</ol>
